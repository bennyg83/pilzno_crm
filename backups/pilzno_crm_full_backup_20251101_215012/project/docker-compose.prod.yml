# Production configuration for Pilzno Synagogue Management System
# Extends the main configuration with production-specific settings
# Usage: docker-compose -f docker-compose.prod.yml up -d

services:
  pilzno-synagogue-db:
    extends:
      file: docker-compose.yml
      service: pilzno-synagogue-db
    container_name: pilzno-synagogue-db-prod
    restart: always
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  pilzno-synagogue-backend:
    extends:
      file: docker-compose.yml
      service: pilzno-synagogue-backend
    container_name: pilzno-synagogue-backend-prod
    environment:
      NODE_ENV: production
      BUILD_TARGET: production
    restart: always
    deploy:
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M

  pilzno-synagogue-frontend:
    extends:
      file: docker-compose.yml
      service: pilzno-synagogue-frontend
    container_name: pilzno-synagogue-frontend-prod
    environment:
      NODE_ENV: production
      BUILD_TARGET: production
    restart: always
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

# Include networks and volumes from main file
networks:
  pilzno-synagogue-network:
    driver: bridge
    ipam:
      config:
        - subnet: ${NETWORK_SUBNET:-172.25.0.0/16}

volumes:
  pilzno-synagogue-db-data:
    driver: local
  backend_logs:
    driver: local 